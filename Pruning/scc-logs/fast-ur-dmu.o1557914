Using GPU: Tesla V100-SXM2-16GB
Layer embedding.conv_1.0: 0/1572864
Layer cls_head.mlp.0: 0/131072
Layer cls_head.mlp.2: 0/128
Memory layer Amemory: 0/30720
Memory layer Nmemory: 0/30720
Layer selfatt.layers.0.0.fn.to_qkv: 0/1048576
Layer selfatt.layers.0.0.fn.to_out.0: 0/524288
Layer selfatt.layers.0.1.fn.net.0: 0/262144
Layer selfatt.layers.0.1.fn.net.3: 0/262144
Layer selfatt.layers.1.0.fn.to_qkv: 0/1048576
Layer selfatt.layers.1.0.fn.to_out.0: 0/524288
Layer selfatt.layers.1.1.fn.net.0: 0/262144
Layer selfatt.layers.1.1.fn.net.3: 0/262144
Layer encoder_mu.0: 0/262144
Layer encoder_var.0: 0/262144

Before pruning:
Total parameters: 6,484,096
Zero parameters: 0
Sparsity: 0.00%

Total unique normal videos: 800
Total unique abnormal videos: 810
Selected 80 normal videos
Selected 81 abnormal videos
Total normal frames selected: 800
Total abnormal frames selected: 810

Example normal videos selected:
Normal_Videos654_x264: 10 frames
Normal_Videos506_x264: 10 frames
Normal_Videos180_x264: 10 frames

Example abnormal videos selected:
RoadAccidents073_x264: 10 frames
Stealing109_x264: 10 frames
RoadAccidents146_x264: 10 frames
Step 0 - AUC: 0.5119, AP: 0.0775

Starting pruning round 1/5
Layer embedding.conv_1.0: 0/1572864
Layer cls_head.mlp.0: 0/131072
Layer cls_head.mlp.2: 0/128
Memory layer Amemory: 0/30720
Memory layer Nmemory: 0/30720
Layer selfatt.layers.0.0.fn.to_qkv: 0/1048576
Layer selfatt.layers.0.0.fn.to_out.0: 0/524288
Layer selfatt.layers.0.1.fn.net.0: 0/262144
Layer selfatt.layers.0.1.fn.net.3: 0/262144
Layer selfatt.layers.1.0.fn.to_qkv: 0/1048576
Layer selfatt.layers.1.0.fn.to_out.0: 0/524288
Layer selfatt.layers.1.1.fn.net.0: 0/262144
Layer selfatt.layers.1.1.fn.net.3: 0/262144
Layer encoder_mu.0: 0/262144
Layer encoder_var.0: 0/262144

Starting pruning with target sparsity: 0.2752
Found prunable layer: embedding.conv_1.0, type: Conv1d
Found prunable layer: cls_head.mlp.0, type: Linear
Found prunable layer: cls_head.mlp.2, type: Linear
Found Memory_Unit layer: Amemory
Found Memory_Unit layer: Nmemory
Found prunable layer: selfatt.layers.0.0.fn.to_qkv, type: Linear
Found prunable layer: selfatt.layers.0.0.fn.to_out.0, type: Linear
Found prunable layer: selfatt.layers.0.1.fn.net.0, type: Linear
Found prunable layer: selfatt.layers.0.1.fn.net.3, type: Linear
Found prunable layer: selfatt.layers.1.0.fn.to_qkv, type: Linear
Found prunable layer: selfatt.layers.1.0.fn.to_out.0, type: Linear
Found prunable layer: selfatt.layers.1.1.fn.net.0, type: Linear
Found prunable layer: selfatt.layers.1.1.fn.net.3, type: Linear
Found prunable layer: encoder_mu.0, type: Linear
Found prunable layer: encoder_var.0, type: Linear

Total prunable layers found: 15

Processing layer: embedding.conv_1.0.weight
  Total weights: 1572864
  Current zeros: 0
  Target zeros: 432884
  Need to prune: 432884
  Threshold value: 0.004967
  Zeros after new mask: 432885

Processing layer: cls_head.mlp.0.weight
  Total weights: 131072
  Current zeros: 0
  Target zeros: 36073
  Need to prune: 36073
  Threshold value: 0.008606
  Zeros after new mask: 36074

Processing layer: cls_head.mlp.2.weight
  Total weights: 128
  Current zeros: 0
  Target zeros: 35
  Need to prune: 35
  Threshold value: 0.023880
  Zeros after new mask: 36

Processing layer: Amemory.memory_block
  Total weights: 30720
  Current zeros: 0
  Target zeros: 8454
  Need to prune: 8454
  Threshold value: 0.012345
  Zeros after new mask: 8455

Processing layer: Nmemory.memory_block
  Total weights: 30720
  Current zeros: 0
  Target zeros: 8454
  Need to prune: 8454
  Threshold value: 0.012253
  Zeros after new mask: 8455

Processing layer: selfatt.layers.0.0.fn.to_qkv.weight
  Total weights: 1048576
  Current zeros: 0
  Target zeros: 288589
  Need to prune: 288589
  Threshold value: 0.012167
  Zeros after new mask: 288590

Processing layer: selfatt.layers.0.0.fn.to_out.0.weight
  Total weights: 524288
  Current zeros: 0
  Target zeros: 144294
  Need to prune: 144294
  Threshold value: 0.008640
  Zeros after new mask: 144295

Processing layer: selfatt.layers.0.1.fn.net.0.weight
  Total weights: 262144
  Current zeros: 0
  Target zeros: 72147
  Need to prune: 72147
  Threshold value: 0.012157
  Zeros after new mask: 72148

Processing layer: selfatt.layers.0.1.fn.net.3.weight
  Total weights: 262144
  Current zeros: 0
  Target zeros: 72147
  Need to prune: 72147
  Threshold value: 0.012165
  Zeros after new mask: 72148

Processing layer: selfatt.layers.1.0.fn.to_qkv.weight
  Total weights: 1048576
  Current zeros: 0
  Target zeros: 288589
  Need to prune: 288589
  Threshold value: 0.012167
  Zeros after new mask: 288590

Processing layer: selfatt.layers.1.0.fn.to_out.0.weight
  Total weights: 524288
  Current zeros: 0
  Target zeros: 144294
  Need to prune: 144294
  Threshold value: 0.008624
  Zeros after new mask: 144295

Processing layer: selfatt.layers.1.1.fn.net.0.weight
  Total weights: 262144
  Current zeros: 0
  Target zeros: 72147
  Need to prune: 72147
  Threshold value: 0.012130
  Zeros after new mask: 72148

Processing layer: selfatt.layers.1.1.fn.net.3.weight
  Total weights: 262144
  Current zeros: 0
  Target zeros: 72147
  Need to prune: 72147
  Threshold value: 0.012123
  Zeros after new mask: 72148

Processing layer: encoder_mu.0.weight
  Total weights: 262144
  Current zeros: 0
  Target zeros: 72147
  Need to prune: 72147
  Threshold value: 0.012195
  Zeros after new mask: 72148

Processing layer: encoder_var.0.weight
  Total weights: 262144
  Current zeros: 0
  Target zeros: 72147
  Need to prune: 72147
  Threshold value: 0.012115
  Zeros after new mask: 72148
Step round_0_start - AUC: 0.5435, AP: 0.0821
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:51,  2.95s/it]  2%|▏         | 2/100 [00:06<05:01,  3.07s/it]  3%|▎         | 3/100 [00:09<04:54,  3.04s/it]  4%|▍         | 4/100 [00:12<04:50,  3.03s/it]  5%|▌         | 5/100 [00:14<04:22,  2.76s/it]  6%|▌         | 6/100 [00:16<03:53,  2.48s/it]  7%|▋         | 7/100 [00:18<03:31,  2.27s/it]  8%|▊         | 8/100 [00:19<03:15,  2.12s/it]  9%|▉         | 9/100 [00:22<03:12,  2.12s/it] 10%|█         | 10/100 [00:40<10:38,  7.09s/it] 11%|█         | 11/100 [00:41<07:59,  5.39s/it] 12%|█▏        | 12/100 [00:43<06:16,  4.28s/it] 13%|█▎        | 13/100 [00:45<05:02,  3.48s/it] 14%|█▍        | 14/100 [00:46<04:02,  2.82s/it] 15%|█▌        | 15/100 [00:47<03:19,  2.34s/it] 16%|█▌        | 16/100 [00:48<02:42,  1.94s/it] 17%|█▋        | 17/100 [00:49<02:18,  1.66s/it] 18%|█▊        | 18/100 [00:50<02:03,  1.50s/it] 19%|█▉        | 19/100 [00:52<01:53,  1.40s/it] 20%|██        | 20/100 [01:07<07:26,  5.58s/it] 21%|██        | 21/100 [01:08<05:30,  4.18s/it] 22%|██▏       | 22/100 [01:09<04:12,  3.24s/it] 23%|██▎       | 23/100 [01:10<03:19,  2.59s/it] 24%|██▍       | 24/100 [01:11<02:37,  2.07s/it] 25%|██▌       | 25/100 [01:12<02:07,  1.71s/it] 26%|██▌       | 26/100 [01:12<01:44,  1.42s/it] 27%|██▋       | 27/100 [01:13<01:31,  1.25s/it] 28%|██▊       | 28/100 [01:14<01:20,  1.12s/it] 29%|██▉       | 29/100 [01:15<01:11,  1.01s/it] 30%|███       | 30/100 [01:30<06:03,  5.20s/it] 31%|███       | 31/100 [01:31<04:28,  3.89s/it] 32%|███▏      | 32/100 [01:32<03:23,  2.99s/it] 33%|███▎      | 33/100 [01:32<02:34,  2.30s/it] 34%|███▍      | 34/100 [01:33<01:59,  1.81s/it] 35%|███▌      | 35/100 [01:34<01:41,  1.57s/it] 36%|███▌      | 36/100 [01:35<01:28,  1.38s/it] 37%|███▋      | 37/100 [01:36<01:15,  1.20s/it] 38%|███▊      | 38/100 [01:36<01:05,  1.06s/it] 39%|███▉      | 39/100 [01:37<00:58,  1.04it/s] 40%|████      | 40/100 [01:51<04:43,  4.73s/it] 41%|████      | 41/100 [01:51<03:26,  3.49s/it] 42%|████▏     | 42/100 [01:52<02:32,  2.63s/it] 43%|████▎     | 43/100 [01:52<01:55,  2.02s/it] 44%|████▍     | 44/100 [01:53<01:29,  1.59s/it] 45%|████▌     | 45/100 [01:54<01:12,  1.32s/it] 46%|████▌     | 46/100 [01:54<00:59,  1.09s/it] 47%|████▋     | 47/100 [01:55<00:53,  1.00s/it] 48%|████▊     | 48/100 [01:56<00:51,  1.01it/s] 49%|████▉     | 49/100 [01:57<00:43,  1.18it/s] 50%|█████     | 50/100 [02:10<03:57,  4.74s/it] 51%|█████     | 51/100 [02:11<02:50,  3.47s/it] 52%|█████▏    | 52/100 [02:11<02:05,  2.61s/it] 53%|█████▎    | 53/100 [02:12<01:33,  2.00s/it] 54%|█████▍    | 54/100 [02:13<01:12,  1.58s/it] 55%|█████▌    | 55/100 [02:13<00:57,  1.27s/it] 56%|█████▌    | 56/100 [02:14<00:48,  1.11s/it] 57%|█████▋    | 57/100 [02:14<00:40,  1.07it/s] 58%|█████▊    | 58/100 [02:15<00:34,  1.21it/s] 59%|█████▉    | 59/100 [02:16<00:30,  1.34it/s] 60%|██████    | 60/100 [02:29<03:03,  4.59s/it] 61%|██████    | 61/100 [02:30<02:10,  3.36s/it] 62%|██████▏   | 62/100 [02:30<01:36,  2.54s/it] 63%|██████▎   | 63/100 [02:31<01:13,  1.99s/it] 64%|██████▍   | 64/100 [02:32<00:56,  1.56s/it] 65%|██████▌   | 65/100 [02:32<00:44,  1.28s/it] 66%|██████▌   | 66/100 [02:33<00:35,  1.05s/it] 67%|██████▋   | 67/100 [02:33<00:29,  1.12it/s] 68%|██████▊   | 68/100 [02:34<00:24,  1.28it/s] 69%|██████▉   | 69/100 [02:34<00:21,  1.46it/s] 70%|███████   | 70/100 [02:48<02:17,  4.59s/it] 71%|███████   | 71/100 [02:48<01:37,  3.36s/it] 72%|███████▏  | 72/100 [02:49<01:11,  2.54s/it] 73%|███████▎  | 73/100 [02:49<00:52,  1.93s/it] 74%|███████▍  | 74/100 [02:50<00:39,  1.51s/it] 75%|███████▌  | 75/100 [02:51<00:30,  1.24s/it] 76%|███████▌  | 76/100 [02:51<00:24,  1.03s/it] 77%|███████▋  | 77/100 [02:52<00:21,  1.08it/s] 78%|███████▊  | 78/100 [02:52<00:18,  1.22it/s] 79%|███████▉  | 79/100 [02:53<00:15,  1.37it/s] 80%|████████  | 80/100 [03:07<01:32,  4.61s/it] 81%|████████  | 81/100 [03:07<01:04,  3.39s/it] 82%|████████▏ | 82/100 [03:08<00:46,  2.56s/it] 83%|████████▎ | 83/100 [03:08<00:33,  1.94s/it] 84%|████████▍ | 84/100 [03:09<00:24,  1.53s/it] 85%|████████▌ | 85/100 [03:09<00:19,  1.27s/it] 86%|████████▌ | 86/100 [03:10<00:14,  1.02s/it] 87%|████████▋ | 87/100 [03:10<00:11,  1.17it/s] 88%|████████▊ | 88/100 [03:11<00:08,  1.35it/s] 89%|████████▉ | 89/100 [03:12<00:08,  1.37it/s] 90%|█████████ | 90/100 [03:25<00:46,  4.63s/it] 91%|█████████ | 91/100 [03:26<00:30,  3.44s/it] 92%|█████████▏| 92/100 [03:27<00:20,  2.57s/it] 93%|█████████▎| 93/100 [03:27<00:13,  1.96s/it] 94%|█████████▍| 94/100 [03:28<00:09,  1.52s/it] 95%|█████████▌| 95/100 [03:28<00:06,  1.26s/it] 96%|█████████▌| 96/100 [03:29<00:04,  1.07s/it] 97%|█████████▋| 97/100 [03:30<00:02,  1.04it/s] 98%|█████████▊| 98/100 [03:30<00:01,  1.22it/s] 99%|█████████▉| 99/100 [03:31<00:00,  1.39it/s]100%|██████████| 100/100 [03:44<00:00,  4.67s/it]100%|██████████| 100/100 [03:44<00:00,  2.25s/it]
Step round_0_step_10 - AUC: 0.6113, AP: 0.0990
Step round_0_step_20 - AUC: 0.6731, AP: 0.1200
Step round_0_step_30 - AUC: 0.7081, AP: 0.1384
Step round_0_step_40 - AUC: 0.7165, AP: 0.1458
Step round_0_step_50 - AUC: 0.7125, AP: 0.1489
Step round_0_step_60 - AUC: 0.7125, AP: 0.1566
Step round_0_step_70 - AUC: 0.7125, AP: 0.1635
Step round_0_step_80 - AUC: 0.7142, AP: 0.1697
Step round_0_step_90 - AUC: 0.7166, AP: 0.1750
Step round_0_step_100 - AUC: 0.7188, AP: 0.1786
Layer embedding.conv_1.0: 432885/1572864
Layer cls_head.mlp.0: 36074/131072
Layer cls_head.mlp.2: 36/128
Memory layer Amemory: 8455/30720
Memory layer Nmemory: 8455/30720
Layer selfatt.layers.0.0.fn.to_qkv: 288590/1048576
Layer selfatt.layers.0.0.fn.to_out.0: 144295/524288
Layer selfatt.layers.0.1.fn.net.0: 72148/262144
Layer selfatt.layers.0.1.fn.net.3: 72148/262144
Layer selfatt.layers.1.0.fn.to_qkv: 288590/1048576
Layer selfatt.layers.1.0.fn.to_out.0: 144295/524288
Layer selfatt.layers.1.1.fn.net.0: 72148/262144
Layer selfatt.layers.1.1.fn.net.3: 72148/262144
Layer encoder_mu.0: 72148/262144
Layer encoder_var.0: 72148/262144

After pruning round 1:
Total parameters: 6,484,096
Zero parameters: 1,784,563
Sparsity: 27.52%


Starting pruning round 2/5
Layer embedding.conv_1.0: 432885/1572864
Layer cls_head.mlp.0: 36074/131072
Layer cls_head.mlp.2: 36/128
Memory layer Amemory: 8455/30720
Memory layer Nmemory: 8455/30720
Layer selfatt.layers.0.0.fn.to_qkv: 288590/1048576
Layer selfatt.layers.0.0.fn.to_out.0: 144295/524288
Layer selfatt.layers.0.1.fn.net.0: 72148/262144
Layer selfatt.layers.0.1.fn.net.3: 72148/262144
Layer selfatt.layers.1.0.fn.to_qkv: 288590/1048576
Layer selfatt.layers.1.0.fn.to_out.0: 144295/524288
Layer selfatt.layers.1.1.fn.net.0: 72148/262144
Layer selfatt.layers.1.1.fn.net.3: 72148/262144
Layer encoder_mu.0: 72148/262144
Layer encoder_var.0: 72148/262144

Starting pruning with target sparsity: 0.4747
Found prunable layer: embedding.conv_1.0, type: Conv1d
Found prunable layer: cls_head.mlp.0, type: Linear
Found prunable layer: cls_head.mlp.2, type: Linear
Found Memory_Unit layer: Amemory
Found Memory_Unit layer: Nmemory
Found prunable layer: selfatt.layers.0.0.fn.to_qkv, type: Linear
Found prunable layer: selfatt.layers.0.0.fn.to_out.0, type: Linear
Found prunable layer: selfatt.layers.0.1.fn.net.0, type: Linear
Found prunable layer: selfatt.layers.0.1.fn.net.3, type: Linear
Found prunable layer: selfatt.layers.1.0.fn.to_qkv, type: Linear
Found prunable layer: selfatt.layers.1.0.fn.to_out.0, type: Linear
Found prunable layer: selfatt.layers.1.1.fn.net.0, type: Linear
Found prunable layer: selfatt.layers.1.1.fn.net.3, type: Linear
Found prunable layer: encoder_mu.0, type: Linear
Found prunable layer: encoder_var.0, type: Linear

Total prunable layers found: 15

Processing layer: embedding.conv_1.0.weight
  Total weights: 1572864
  Current zeros: 432885
  Target zeros: 746629
  Need to prune: 313744
  Threshold value: 0.008561
  Zeros after new mask: 746630

Processing layer: cls_head.mlp.0.weight
  Total weights: 131072
  Current zeros: 36074
  Target zeros: 62219
  Need to prune: 26145
  Threshold value: 0.014837
  Zeros after new mask: 62220

Processing layer: cls_head.mlp.2.weight
  Total weights: 128
  Current zeros: 36
  Target zeros: 60
  Need to prune: 24
  Threshold value: 0.041463
  Zeros after new mask: 61

Processing layer: Amemory.memory_block
  Total weights: 30720
  Current zeros: 8455
  Target zeros: 14582
  Need to prune: 6127
  Threshold value: 0.021219
  Zeros after new mask: 14583

Processing layer: Nmemory.memory_block
  Total weights: 30720
  Current zeros: 8455
  Target zeros: 14582
  Need to prune: 6127
  Threshold value: 0.021014
  Zeros after new mask: 14583

Processing layer: selfatt.layers.0.0.fn.to_qkv.weight
  Total weights: 1048576
  Current zeros: 288590
  Target zeros: 497753
  Need to prune: 209163
  Threshold value: 0.020988
  Zeros after new mask: 497754

Processing layer: selfatt.layers.0.0.fn.to_out.0.weight
  Total weights: 524288
  Current zeros: 144295
  Target zeros: 248876
  Need to prune: 104581
  Threshold value: 0.014845
  Zeros after new mask: 248877

Processing layer: selfatt.layers.0.1.fn.net.0.weight
  Total weights: 262144
  Current zeros: 72148
  Target zeros: 124438
  Need to prune: 52290
  Threshold value: 0.020950
  Zeros after new mask: 124439

Processing layer: selfatt.layers.0.1.fn.net.3.weight
  Total weights: 262144
  Current zeros: 72148
  Target zeros: 124438
  Need to prune: 52290
  Threshold value: 0.020941
  Zeros after new mask: 124439

Processing layer: selfatt.layers.1.0.fn.to_qkv.weight
  Total weights: 1048576
  Current zeros: 288590
  Target zeros: 497753
  Need to prune: 209163
  Threshold value: 0.021002
  Zeros after new mask: 497754

Processing layer: selfatt.layers.1.0.fn.to_out.0.weight
  Total weights: 524288
  Current zeros: 144295
  Target zeros: 248876
  Need to prune: 104581
  Threshold value: 0.014857
  Zeros after new mask: 248877

Processing layer: selfatt.layers.1.1.fn.net.0.weight
  Total weights: 262144
  Current zeros: 72148
  Target zeros: 124438
  Need to prune: 52290
  Threshold value: 0.020898
  Zeros after new mask: 124439

Processing layer: selfatt.layers.1.1.fn.net.3.weight
  Total weights: 262144
  Current zeros: 72148
  Target zeros: 124438
  Need to prune: 52290
  Threshold value: 0.020961
  Zeros after new mask: 124439

Processing layer: encoder_mu.0.weight
  Total weights: 262144
  Current zeros: 72148
  Target zeros: 124438
  Need to prune: 52290
  Threshold value: 0.020970
  Zeros after new mask: 124439

Processing layer: encoder_var.0.weight
  Total weights: 262144
  Current zeros: 72148
  Target zeros: 124438
  Need to prune: 52290
  Threshold value: 0.020961
  Zeros after new mask: 124439
Step round_1_start - AUC: 0.7141, AP: 0.1543
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:56,  1.76it/s]  2%|▏         | 2/100 [00:01<00:49,  1.96it/s]  3%|▎         | 3/100 [00:01<00:54,  1.78it/s]  4%|▍         | 4/100 [00:02<00:54,  1.77it/s]  5%|▌         | 5/100 [00:02<00:50,  1.88it/s]  6%|▌         | 6/100 [00:03<00:51,  1.82it/s]  7%|▋         | 7/100 [00:03<00:53,  1.75it/s]  8%|▊         | 8/100 [00:04<00:54,  1.69it/s]  9%|▉         | 9/100 [00:05<00:50,  1.79it/s] 10%|█         | 10/100 [00:19<07:04,  4.72s/it] 11%|█         | 11/100 [00:19<05:07,  3.46s/it] 12%|█▏        | 12/100 [00:20<03:48,  2.59s/it] 13%|█▎        | 13/100 [00:20<02:55,  2.01s/it] 14%|█▍        | 14/100 [00:21<02:13,  1.55s/it] 15%|█▌        | 15/100 [00:22<01:50,  1.30s/it] 16%|█▌        | 16/100 [00:22<01:27,  1.04s/it] 17%|█▋        | 17/100 [00:23<01:16,  1.09it/s] 18%|█▊        | 18/100 [00:23<01:06,  1.23it/s] 19%|█▉        | 19/100 [00:24<00:59,  1.37it/s] 20%|██        | 20/100 [00:37<06:06,  4.58s/it] 21%|██        | 21/100 [00:38<04:26,  3.37s/it] 22%|██▏       | 22/100 [00:38<03:14,  2.50s/it] 23%|██▎       | 23/100 [00:39<02:26,  1.90s/it] 24%|██▍       | 24/100 [00:39<01:52,  1.48s/it] 25%|██▌       | 25/100 [00:40<01:31,  1.22s/it] 26%|██▌       | 26/100 [00:41<01:16,  1.03s/it] 27%|██▋       | 27/100 [00:41<01:04,  1.13it/s] 28%|██▊       | 28/100 [00:42<00:56,  1.27it/s] 29%|██▉       | 29/100 [00:42<00:53,  1.34it/s] 30%|███       | 30/100 [00:56<05:23,  4.62s/it] 31%|███       | 31/100 [00:56<03:53,  3.38s/it] 32%|███▏      | 32/100 [00:57<02:52,  2.54s/it] 33%|███▎      | 33/100 [00:58<02:09,  1.94s/it] 34%|███▍      | 34/100 [00:58<01:41,  1.54s/it] 35%|███▌      | 35/100 [00:59<01:20,  1.23s/it] 36%|███▌      | 36/100 [00:59<01:04,  1.01s/it] 37%|███▋      | 37/100 [01:00<00:54,  1.15it/s] 38%|███▊      | 38/100 [01:00<00:49,  1.26it/s] 39%|███▉      | 39/100 [01:01<00:43,  1.40it/s] 40%|████      | 40/100 [01:15<04:44,  4.74s/it] 41%|████      | 41/100 [01:16<03:27,  3.52s/it] 42%|████▏     | 42/100 [01:16<02:33,  2.64s/it] 43%|████▎     | 43/100 [01:17<01:54,  2.00s/it] 44%|████▍     | 44/100 [01:17<01:27,  1.56s/it] 45%|████▌     | 45/100 [01:18<01:09,  1.27s/it] 46%|████▌     | 46/100 [01:18<00:56,  1.05s/it] 47%|████▋     | 47/100 [01:19<00:49,  1.08it/s] 48%|████▊     | 48/100 [01:20<00:44,  1.16it/s] 49%|████▉     | 49/100 [01:20<00:39,  1.29it/s] 50%|█████     | 50/100 [01:34<03:51,  4.63s/it] 51%|█████     | 51/100 [01:35<02:49,  3.46s/it] 52%|█████▏    | 52/100 [01:35<02:04,  2.59s/it] 53%|█████▎    | 53/100 [01:36<01:32,  1.96s/it] 54%|█████▍    | 54/100 [01:36<01:11,  1.55s/it] 55%|█████▌    | 55/100 [01:37<00:56,  1.25s/it] 56%|█████▌    | 56/100 [01:37<00:44,  1.02s/it] 57%|█████▋    | 57/100 [01:38<00:37,  1.15it/s] 58%|█████▊    | 58/100 [01:39<00:32,  1.28it/s] 59%|█████▉    | 59/100 [01:39<00:30,  1.36it/s] 60%|██████    | 60/100 [01:53<03:03,  4.58s/it] 61%|██████    | 61/100 [01:54<02:14,  3.46s/it] 62%|██████▏   | 62/100 [01:54<01:39,  2.61s/it] 63%|██████▎   | 63/100 [01:55<01:15,  2.03s/it] 64%|██████▍   | 64/100 [01:55<00:57,  1.60s/it] 65%|██████▌   | 65/100 [01:56<00:45,  1.31s/it] 66%|██████▌   | 66/100 [01:57<00:36,  1.07s/it] 67%|██████▋   | 67/100 [01:57<00:30,  1.09it/s] 68%|██████▊   | 68/100 [01:58<00:27,  1.16it/s] 69%|██████▉   | 69/100 [01:59<00:24,  1.24it/s] 70%|███████   | 70/100 [02:12<02:21,  4.72s/it] 71%|███████   | 71/100 [02:13<01:41,  3.50s/it] 72%|███████▏  | 72/100 [02:14<01:12,  2.59s/it] 73%|███████▎  | 73/100 [02:14<00:53,  1.96s/it] 74%|███████▍  | 74/100 [02:15<00:41,  1.59s/it] 75%|███████▌  | 75/100 [02:15<00:31,  1.26s/it] 76%|███████▌  | 76/100 [02:16<00:25,  1.08s/it] 77%|███████▋  | 77/100 [02:16<00:20,  1.10it/s] 78%|███████▊  | 78/100 [02:17<00:18,  1.17it/s] 79%|███████▉  | 79/100 [02:18<00:17,  1.23it/s] 80%|████████  | 80/100 [02:32<01:34,  4.72s/it] 81%|████████  | 81/100 [02:32<01:06,  3.49s/it] 82%|████████▏ | 82/100 [02:33<00:48,  2.71s/it] 83%|████████▎ | 83/100 [02:34<00:35,  2.06s/it] 84%|████████▍ | 84/100 [02:34<00:25,  1.59s/it] 85%|████████▌ | 85/100 [02:35<00:20,  1.35s/it] 86%|████████▌ | 86/100 [02:35<00:15,  1.08s/it] 87%|████████▋ | 87/100 [02:36<00:12,  1.04it/s] 88%|████████▊ | 88/100 [02:37<00:09,  1.20it/s] 89%|████████▉ | 89/100 [02:37<00:08,  1.36it/s] 90%|█████████ | 90/100 [02:51<00:47,  4.77s/it] 91%|█████████ | 91/100 [02:52<00:31,  3.51s/it] 92%|█████████▏| 92/100 [02:53<00:20,  2.62s/it] 93%|█████████▎| 93/100 [02:53<00:13,  1.97s/it] 94%|█████████▍| 94/100 [02:53<00:09,  1.54s/it] 95%|█████████▌| 95/100 [02:54<00:06,  1.25s/it] 96%|█████████▌| 96/100 [02:55<00:04,  1.05s/it] 97%|█████████▋| 97/100 [02:55<00:02,  1.08it/s] 98%|█████████▊| 98/100 [02:56<00:01,  1.16it/s] 99%|█████████▉| 99/100 [02:57<00:00,  1.29it/s]100%|██████████| 100/100 [03:11<00:00,  4.81s/it]100%|██████████| 100/100 [03:11<00:00,  1.91s/it]
Step round_1_step_10 - AUC: 0.7182, AP: 0.1562
Step round_1_step_20 - AUC: 0.7214, AP: 0.1599
Step round_1_step_30 - AUC: 0.7248, AP: 0.1642
Step round_1_step_40 - AUC: 0.7274, AP: 0.1674
Step round_1_step_50 - AUC: 0.7311, AP: 0.1722
Step round_1_step_60 - AUC: 0.7318, AP: 0.1731
Step round_1_step_70 - AUC: 0.7333, AP: 0.1745
Step round_1_step_80 - AUC: 0.7348, AP: 0.1770
Step round_1_step_90 - AUC: 0.7342, AP: 0.1769
Step round_1_step_100 - AUC: 0.7346, AP: 0.1777
Layer embedding.conv_1.0: 746630/1572864
Layer cls_head.mlp.0: 62220/131072
Layer cls_head.mlp.2: 61/128
Memory layer Amemory: 14583/30720
Memory layer Nmemory: 14583/30720
Layer selfatt.layers.0.0.fn.to_qkv: 497754/1048576
Layer selfatt.layers.0.0.fn.to_out.0: 248877/524288
Layer selfatt.layers.0.1.fn.net.0: 124439/262144
Layer selfatt.layers.0.1.fn.net.3: 124439/262144
Layer selfatt.layers.1.0.fn.to_qkv: 497754/1048576
Layer selfatt.layers.1.0.fn.to_out.0: 248877/524288
Layer selfatt.layers.1.1.fn.net.0: 124439/262144
Layer selfatt.layers.1.1.fn.net.3: 124439/262144
Layer encoder_mu.0: 124439/262144
Layer encoder_var.0: 124439/262144

After pruning round 2:
Total parameters: 6,484,096
Zero parameters: 3,077,973
Sparsity: 47.47%


Starting pruning round 3/5
Layer embedding.conv_1.0: 746630/1572864
Layer cls_head.mlp.0: 62220/131072
Layer cls_head.mlp.2: 61/128
Memory layer Amemory: 14583/30720
Memory layer Nmemory: 14583/30720
Layer selfatt.layers.0.0.fn.to_qkv: 497754/1048576
Layer selfatt.layers.0.0.fn.to_out.0: 248877/524288
Layer selfatt.layers.0.1.fn.net.0: 124439/262144
Layer selfatt.layers.0.1.fn.net.3: 124439/262144
Layer selfatt.layers.1.0.fn.to_qkv: 497754/1048576
Layer selfatt.layers.1.0.fn.to_out.0: 248877/524288
Layer selfatt.layers.1.1.fn.net.0: 124439/262144
Layer selfatt.layers.1.1.fn.net.3: 124439/262144
Layer encoder_mu.0: 124439/262144
Layer encoder_var.0: 124439/262144

Starting pruning with target sparsity: 0.6193
Found prunable layer: embedding.conv_1.0, type: Conv1d
Found prunable layer: cls_head.mlp.0, type: Linear
Found prunable layer: cls_head.mlp.2, type: Linear
Found Memory_Unit layer: Amemory
Found Memory_Unit layer: Nmemory
Found prunable layer: selfatt.layers.0.0.fn.to_qkv, type: Linear
Found prunable layer: selfatt.layers.0.0.fn.to_out.0, type: Linear
Found prunable layer: selfatt.layers.0.1.fn.net.0, type: Linear
Found prunable layer: selfatt.layers.0.1.fn.net.3, type: Linear
Found prunable layer: selfatt.layers.1.0.fn.to_qkv, type: Linear
Found prunable layer: selfatt.layers.1.0.fn.to_out.0, type: Linear
Found prunable layer: selfatt.layers.1.1.fn.net.0, type: Linear
Found prunable layer: selfatt.layers.1.1.fn.net.3, type: Linear
Found prunable layer: encoder_mu.0, type: Linear
Found prunable layer: encoder_var.0, type: Linear

Total prunable layers found: 15

Processing layer: embedding.conv_1.0.weight
  Total weights: 1572864
  Current zeros: 746630
  Target zeros: 974026
  Need to prune: 227396
  Threshold value: 0.011173
  Zeros after new mask: 974027

Processing layer: cls_head.mlp.0.weight
  Total weights: 131072
  Current zeros: 62220
  Target zeros: 81168
  Need to prune: 18948
  Threshold value: 0.019377
  Zeros after new mask: 81169

Processing layer: cls_head.mlp.2.weight
  Total weights: 128
  Current zeros: 61
  Target zeros: 79
  Need to prune: 18
  Threshold value: 0.053571
  Zeros after new mask: 80

Processing layer: Amemory.memory_block
  Total weights: 30720
  Current zeros: 14583
  Target zeros: 19023
  Need to prune: 4440
  Threshold value: 0.027547
  Zeros after new mask: 19024

Processing layer: Nmemory.memory_block
  Total weights: 30720
  Current zeros: 14583
  Target zeros: 19023
  Need to prune: 4440
  Threshold value: 0.027269
  Zeros after new mask: 19024

Processing layer: selfatt.layers.0.0.fn.to_qkv.weight
  Total weights: 1048576
  Current zeros: 497754
  Target zeros: 649350
  Need to prune: 151596
  Threshold value: 0.027384
  Zeros after new mask: 649351

Processing layer: selfatt.layers.0.0.fn.to_out.0.weight
  Total weights: 524288
  Current zeros: 248877
  Target zeros: 324675
  Need to prune: 75798
  Threshold value: 0.019368
  Zeros after new mask: 324676

Processing layer: selfatt.layers.0.1.fn.net.0.weight
  Total weights: 262144
  Current zeros: 124439
  Target zeros: 162337
  Need to prune: 37898
  Threshold value: 0.027394
  Zeros after new mask: 162338

Processing layer: selfatt.layers.0.1.fn.net.3.weight
  Total weights: 262144
  Current zeros: 124439
  Target zeros: 162337
  Need to prune: 37898
  Threshold value: 0.027343
  Zeros after new mask: 162338

Processing layer: selfatt.layers.1.0.fn.to_qkv.weight
  Total weights: 1048576
  Current zeros: 497754
  Target zeros: 649350
  Need to prune: 151596
  Threshold value: 0.027414
  Zeros after new mask: 649351

Processing layer: selfatt.layers.1.0.fn.to_out.0.weight
  Total weights: 524288
  Current zeros: 248877
  Target zeros: 324675
  Need to prune: 75798
  Threshold value: 0.019367
  Zeros after new mask: 324676

Processing layer: selfatt.layers.1.1.fn.net.0.weight
  Total weights: 262144
  Current zeros: 124439
  Target zeros: 162337
  Need to prune: 37898
  Threshold value: 0.027308
  Zeros after new mask: 162338

Processing layer: selfatt.layers.1.1.fn.net.3.weight
  Total weights: 262144
  Current zeros: 124439
  Target zeros: 162337
  Need to prune: 37898
  Threshold value: 0.027372
  Zeros after new mask: 162338

Processing layer: encoder_mu.0.weight
  Total weights: 262144
  Current zeros: 124439
  Target zeros: 162337
  Need to prune: 37898
  Threshold value: 0.027390
  Zeros after new mask: 162338

Processing layer: encoder_var.0.weight
  Total weights: 262144
  Current zeros: 124439
  Target zeros: 162337
  Need to prune: 37898
  Threshold value: 0.027300
  Zeros after new mask: 162338
Step round_2_start - AUC: 0.7181, AP: 0.1572
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:55,  1.79it/s]  2%|▏         | 2/100 [00:01<00:50,  1.95it/s]  3%|▎         | 3/100 [00:01<00:50,  1.91it/s]  4%|▍         | 4/100 [00:02<00:54,  1.78it/s]  5%|▌         | 5/100 [00:02<00:53,  1.78it/s]  6%|▌         | 6/100 [00:03<00:54,  1.73it/s]  7%|▋         | 7/100 [00:03<00:52,  1.79it/s]  8%|▊         | 8/100 [00:04<00:51,  1.80it/s]  9%|▉         | 9/100 [00:05<00:55,  1.65it/s] 10%|█         | 10/100 [00:18<07:01,  4.69s/it] 11%|█         | 11/100 [00:19<05:07,  3.45s/it] 12%|█▏        | 12/100 [00:20<03:52,  2.64s/it] 13%|█▎        | 13/100 [00:20<02:52,  1.98s/it] 14%|█▍        | 14/100 [00:21<02:13,  1.56s/it] 15%|█▌        | 15/100 [00:21<01:44,  1.23s/it] 16%|█▌        | 16/100 [00:22<01:26,  1.03s/it] 17%|█▋        | 17/100 [00:23<01:13,  1.13it/s] 18%|█▊        | 18/100 [00:23<01:02,  1.31it/s] 19%|█▉        | 19/100 [00:24<00:56,  1.43it/s] 20%|██        | 20/100 [00:37<05:58,  4.49s/it] 21%|██        | 21/100 [00:37<04:18,  3.27s/it] 22%|██▏       | 22/100 [00:38<03:11,  2.46s/it] 23%|██▎       | 23/100 [00:38<02:25,  1.89s/it] 24%|██▍       | 24/100 [00:39<01:53,  1.50s/it] 25%|██▌       | 25/100 [00:40<01:33,  1.25s/it] 26%|██▌       | 26/100 [00:40<01:15,  1.02s/it] 27%|██▋       | 27/100 [00:41<01:03,  1.15it/s] 28%|██▊       | 28/100 [00:41<00:57,  1.24it/s] 29%|██▉       | 29/100 [00:42<00:51,  1.38it/s] 30%|███       | 30/100 [00:55<05:12,  4.46s/it] 31%|███       | 31/100 [00:56<03:46,  3.28s/it] 32%|███▏      | 32/100 [00:56<02:49,  2.49s/it] 33%|███▎      | 33/100 [00:57<02:08,  1.92s/it] 34%|███▍      | 34/100 [00:58<01:41,  1.54s/it] 35%|███▌      | 35/100 [00:58<01:20,  1.25s/it] 36%|███▌      | 36/100 [00:59<01:07,  1.05s/it] 37%|███▋      | 37/100 [00:59<00:58,  1.07it/s] 38%|███▊      | 38/100 [01:00<00:49,  1.26it/s] 39%|███▉      | 39/100 [01:00<00:44,  1.37it/s] 40%|████      | 40/100 [01:14<04:27,  4.46s/it] 41%|████      | 41/100 [01:14<03:14,  3.30s/it] 42%|████▏     | 42/100 [01:15<02:23,  2.47s/it] 43%|████▎     | 43/100 [01:15<01:47,  1.89s/it] 44%|████▍     | 44/100 [01:16<01:22,  1.48s/it] 45%|████▌     | 45/100 [01:16<01:04,  1.17s/it] 46%|████▌     | 46/100 [01:17<00:53,  1.01it/s] 47%|████▋     | 47/100 [01:17<00:45,  1.18it/s] 48%|████▊     | 48/100 [01:18<00:39,  1.33it/s] 49%|████▉     | 49/100 [01:18<00:33,  1.52it/s] 50%|█████     | 50/100 [01:31<03:41,  4.42s/it] 51%|█████     | 51/100 [01:32<02:41,  3.31s/it] 52%|█████▏    | 52/100 [01:33<01:58,  2.46s/it] 53%|█████▎    | 53/100 [01:33<01:27,  1.86s/it] 54%|█████▍    | 54/100 [01:34<01:06,  1.45s/it] 55%|█████▌    | 55/100 [01:34<00:54,  1.20s/it] 56%|█████▌    | 56/100 [01:35<00:44,  1.00s/it] 57%|█████▋    | 57/100 [01:35<00:37,  1.14it/s] 58%|█████▊    | 58/100 [01:36<00:32,  1.29it/s] 59%|█████▉    | 59/100 [01:36<00:27,  1.48it/s] 60%|██████    | 60/100 [01:49<02:55,  4.39s/it] 61%|██████    | 61/100 [01:50<02:05,  3.22s/it] 62%|██████▏   | 62/100 [01:50<01:32,  2.43s/it] 63%|██████▎   | 63/100 [01:51<01:08,  1.85s/it] 64%|██████▍   | 64/100 [01:52<00:54,  1.53s/it] 65%|██████▌   | 65/100 [01:52<00:42,  1.20s/it] 66%|██████▌   | 66/100 [01:53<00:36,  1.06s/it] 67%|██████▋   | 67/100 [01:53<00:30,  1.09it/s] 68%|██████▊   | 68/100 [01:54<00:24,  1.28it/s] 69%|██████▉   | 69/100 [01:54<00:21,  1.44it/s] 70%|███████   | 70/100 [02:08<02:13,  4.45s/it] 71%|███████   | 71/100 [02:08<01:34,  3.26s/it] 72%|███████▏  | 72/100 [02:09<01:07,  2.42s/it] 73%|███████▎  | 73/100 [02:09<00:50,  1.88s/it] 74%|███████▍  | 74/100 [02:10<00:37,  1.46s/it] 75%|███████▌  | 75/100 [02:10<00:30,  1.24s/it] 76%|███████▌  | 76/100 [02:11<00:23,  1.00it/s] 77%|███████▋  | 77/100 [02:11<00:19,  1.18it/s] 78%|███████▊  | 78/100 [02:12<00:16,  1.37it/s] 79%|███████▉  | 79/100 [02:12<00:13,  1.54it/s] 80%|████████  | 80/100 [02:25<01:28,  4.43s/it] 81%|████████  | 81/100 [02:26<01:02,  3.27s/it] 82%|████████▏ | 82/100 [02:27<00:44,  2.46s/it] 83%|████████▎ | 83/100 [02:27<00:32,  1.89s/it] 84%|████████▍ | 84/100 [02:28<00:23,  1.49s/it] 85%|████████▌ | 85/100 [02:28<00:17,  1.19s/it] 86%|████████▌ | 86/100 [02:29<00:14,  1.00s/it] 87%|████████▋ | 87/100 [02:29<00:11,  1.12it/s] 88%|████████▊ | 88/100 [02:30<00:10,  1.19it/s] 89%|████████▉ | 89/100 [02:31<00:08,  1.32it/s] 90%|█████████ | 90/100 [02:44<00:46,  4.61s/it] 91%|█████████ | 91/100 [02:45<00:30,  3.39s/it] 92%|█████████▏| 92/100 [02:45<00:20,  2.52s/it] 93%|█████████▎| 93/100 [02:46<00:13,  1.93s/it] 94%|█████████▍| 94/100 [02:46<00:09,  1.51s/it] 95%|█████████▌| 95/100 [02:47<00:06,  1.22s/it] 96%|█████████▌| 96/100 [02:48<00:04,  1.03s/it] 97%|█████████▋| 97/100 [02:48<00:02,  1.16it/s] 98%|█████████▊| 98/100 [02:49<00:01,  1.29it/s] 99%|█████████▉| 99/100 [02:49<00:00,  1.39it/s]100%|██████████| 100/100 [03:03<00:00,  4.55s/it]100%|██████████| 100/100 [03:03<00:00,  1.83s/it]
Step round_2_step_10 - AUC: 0.7166, AP: 0.1597
Step round_2_step_20 - AUC: 0.7208, AP: 0.1586
Step round_2_step_30 - AUC: 0.7245, AP: 0.1603
Step round_2_step_40 - AUC: 0.7275, AP: 0.1613
Step round_2_step_50 - AUC: 0.7306, AP: 0.1622
Step round_2_step_60 - AUC: 0.7333, AP: 0.1626
Step round_2_step_70 - AUC: 0.7356, AP: 0.1636
Step round_2_step_80 - AUC: 0.7377, AP: 0.1648
Step round_2_step_90 - AUC: 0.7403, AP: 0.1657
Step round_2_step_100 - AUC: 0.7415, AP: 0.1660
Layer embedding.conv_1.0: 974027/1572864
Layer cls_head.mlp.0: 81169/131072
Layer cls_head.mlp.2: 80/128
Memory layer Amemory: 19024/30720
Memory layer Nmemory: 19024/30720
Layer selfatt.layers.0.0.fn.to_qkv: 649351/1048576
Layer selfatt.layers.0.0.fn.to_out.0: 324676/524288
Layer selfatt.layers.0.1.fn.net.0: 162338/262144
Layer selfatt.layers.0.1.fn.net.3: 162338/262144
Layer selfatt.layers.1.0.fn.to_qkv: 649351/1048576
Layer selfatt.layers.1.0.fn.to_out.0: 324676/524288
Layer selfatt.layers.1.1.fn.net.0: 162338/262144
Layer selfatt.layers.1.1.fn.net.3: 162338/262144
Layer encoder_mu.0: 162338/262144
Layer encoder_var.0: 162338/262144

After pruning round 3:
Total parameters: 6,484,096
Zero parameters: 4,015,406
Sparsity: 61.93%


Starting pruning round 4/5
Layer embedding.conv_1.0: 974027/1572864
Layer cls_head.mlp.0: 81169/131072
Layer cls_head.mlp.2: 80/128
Memory layer Amemory: 19024/30720
Memory layer Nmemory: 19024/30720
Layer selfatt.layers.0.0.fn.to_qkv: 649351/1048576
Layer selfatt.layers.0.0.fn.to_out.0: 324676/524288
Layer selfatt.layers.0.1.fn.net.0: 162338/262144
Layer selfatt.layers.0.1.fn.net.3: 162338/262144
Layer selfatt.layers.1.0.fn.to_qkv: 649351/1048576
Layer selfatt.layers.1.0.fn.to_out.0: 324676/524288
Layer selfatt.layers.1.1.fn.net.0: 162338/262144
Layer selfatt.layers.1.1.fn.net.3: 162338/262144
Layer encoder_mu.0: 162338/262144
Layer encoder_var.0: 162338/262144

Starting pruning with target sparsity: 0.7241
Found prunable layer: embedding.conv_1.0, type: Conv1d
Found prunable layer: cls_head.mlp.0, type: Linear
Found prunable layer: cls_head.mlp.2, type: Linear
Found Memory_Unit layer: Amemory
Found Memory_Unit layer: Nmemory
Found prunable layer: selfatt.layers.0.0.fn.to_qkv, type: Linear
Found prunable layer: selfatt.layers.0.0.fn.to_out.0, type: Linear
Found prunable layer: selfatt.layers.0.1.fn.net.0, type: Linear
Found prunable layer: selfatt.layers.0.1.fn.net.3, type: Linear
Found prunable layer: selfatt.layers.1.0.fn.to_qkv, type: Linear
Found prunable layer: selfatt.layers.1.0.fn.to_out.0, type: Linear
Found prunable layer: selfatt.layers.1.1.fn.net.0, type: Linear
Found prunable layer: selfatt.layers.1.1.fn.net.3, type: Linear
Found prunable layer: encoder_mu.0, type: Linear
Found prunable layer: encoder_var.0, type: Linear

Total prunable layers found: 15

Processing layer: embedding.conv_1.0.weight
  Total weights: 1572864
  Current zeros: 974027
  Target zeros: 1138838
  Need to prune: 164811
  Threshold value: 0.013063
  Zeros after new mask: 1138839

Processing layer: cls_head.mlp.0.weight
  Total weights: 131072
  Current zeros: 81169
  Target zeros: 94903
  Need to prune: 13734
  Threshold value: 0.022684
  Zeros after new mask: 94904

Processing layer: cls_head.mlp.2.weight
  Total weights: 128
  Current zeros: 80
  Target zeros: 92
  Need to prune: 12
  Threshold value: 0.064608
  Zeros after new mask: 93

Processing layer: Amemory.memory_block
  Total weights: 30720
  Current zeros: 19024
  Target zeros: 22242
  Need to prune: 3218
  Threshold value: 0.032135
  Zeros after new mask: 22243

Processing layer: Nmemory.memory_block
  Total weights: 30720
  Current zeros: 19024
  Target zeros: 22242
  Need to prune: 3218
  Threshold value: 0.031843
  Zeros after new mask: 22243

Processing layer: selfatt.layers.0.0.fn.to_qkv.weight
  Total weights: 1048576
  Current zeros: 649351
  Target zeros: 759225
  Need to prune: 109874
  Threshold value: 0.032030
  Zeros after new mask: 759226

Processing layer: selfatt.layers.0.0.fn.to_out.0.weight
  Total weights: 524288
  Current zeros: 324676
  Target zeros: 379612
  Need to prune: 54936
  Threshold value: 0.022646
  Zeros after new mask: 379613

Processing layer: selfatt.layers.0.1.fn.net.0.weight
  Total weights: 262144
  Current zeros: 162338
  Target zeros: 189806
  Need to prune: 27468
  Threshold value: 0.032002
  Zeros after new mask: 189807

Processing layer: selfatt.layers.0.1.fn.net.3.weight
  Total weights: 262144
  Current zeros: 162338
  Target zeros: 189806
  Need to prune: 27468
  Threshold value: 0.032006
  Zeros after new mask: 189807

Processing layer: selfatt.layers.1.0.fn.to_qkv.weight
  Total weights: 1048576
  Current zeros: 649351
  Target zeros: 759225
  Need to prune: 109874
  Threshold value: 0.032048
  Zeros after new mask: 759226

Processing layer: selfatt.layers.1.0.fn.to_out.0.weight
  Total weights: 524288
  Current zeros: 324676
  Target zeros: 379612
  Need to prune: 54936
  Threshold value: 0.022644
  Zeros after new mask: 379613

Processing layer: selfatt.layers.1.1.fn.net.0.weight
  Total weights: 262144
  Current zeros: 162338
  Target zeros: 189806
  Need to prune: 27468
  Threshold value: 0.031963
  Zeros after new mask: 189807

Processing layer: selfatt.layers.1.1.fn.net.3.weight
  Total weights: 262144
  Current zeros: 162338
  Target zeros: 189806
  Need to prune: 27468
  Threshold value: 0.031941
  Zeros after new mask: 189807

Processing layer: encoder_mu.0.weight
  Total weights: 262144
  Current zeros: 162338
  Target zeros: 189806
  Need to prune: 27468
  Threshold value: 0.032032
  Zeros after new mask: 189807

Processing layer: encoder_var.0.weight
  Total weights: 262144
  Current zeros: 162338
  Target zeros: 189806
  Need to prune: 27468
  Threshold value: 0.031939
  Zeros after new mask: 189807
Step round_3_start - AUC: 0.7154, AP: 0.1483
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<01:12,  1.36it/s]  2%|▏         | 2/100 [00:01<00:58,  1.67it/s]  3%|▎         | 3/100 [00:01<00:55,  1.75it/s]  4%|▍         | 4/100 [00:02<00:58,  1.63it/s]  5%|▌         | 5/100 [00:03<00:58,  1.63it/s]  6%|▌         | 6/100 [00:03<00:56,  1.66it/s]  7%|▋         | 7/100 [00:04<00:56,  1.64it/s]  8%|▊         | 8/100 [00:04<00:53,  1.73it/s]  9%|▉         | 9/100 [00:05<00:55,  1.65it/s] 10%|█         | 10/100 [00:19<06:59,  4.66s/it] 11%|█         | 11/100 [00:19<05:03,  3.41s/it] 12%|█▏        | 12/100 [00:20<03:47,  2.58s/it] 13%|█▎        | 13/100 [00:21<02:51,  1.98s/it] 14%|█▍        | 14/100 [00:21<02:13,  1.55s/it] 15%|█▌        | 15/100 [00:22<01:46,  1.25s/it] 16%|█▌        | 16/100 [00:22<01:29,  1.07s/it] 17%|█▋        | 17/100 [00:23<01:14,  1.12it/s] 18%|█▊        | 18/100 [00:23<01:02,  1.31it/s] 19%|█▉        | 19/100 [00:24<00:54,  1.49it/s] 20%|██        | 20/100 [00:37<06:00,  4.50s/it] 21%|██        | 21/100 [00:38<04:23,  3.33s/it] 22%|██▏       | 22/100 [00:38<03:17,  2.53s/it] 23%|██▎       | 23/100 [00:39<02:29,  1.94s/it] 24%|██▍       | 24/100 [00:40<01:56,  1.53s/it] 25%|██▌       | 25/100 [00:40<01:33,  1.25s/it] 26%|██▌       | 26/100 [00:41<01:16,  1.03s/it] 27%|██▋       | 27/100 [00:41<01:04,  1.14it/s] 28%|██▊       | 28/100 [00:42<00:58,  1.22it/s] 29%|██▉       | 29/100 [00:42<00:53,  1.33it/s] 30%|███       | 30/100 [00:56<05:24,  4.63s/it] 31%|███       | 31/100 [00:57<03:56,  3.42s/it] 32%|███▏      | 32/100 [00:57<02:54,  2.57s/it] 33%|███▎      | 33/100 [00:58<02:13,  2.00s/it] 34%|███▍      | 34/100 [00:59<01:45,  1.59s/it] 35%|███▌      | 35/100 [00:59<01:22,  1.27s/it] 36%|███▌      | 36/100 [01:00<01:07,  1.06s/it] 37%|███▋      | 37/100 [01:00<00:56,  1.11it/s] 38%|███▊      | 38/100 [01:01<00:48,  1.27it/s] 39%|███▉      | 39/100 [01:01<00:43,  1.42it/s] 40%|████      | 40/100 [01:15<04:39,  4.66s/it] 41%|████      | 41/100 [01:16<03:21,  3.42s/it] 42%|████▏     | 42/100 [01:16<02:27,  2.55s/it] 43%|████▎     | 43/100 [01:17<01:50,  1.93s/it] 44%|████▍     | 44/100 [01:17<01:27,  1.57s/it] 45%|████▌     | 45/100 [01:18<01:12,  1.32s/it] 46%|████▌     | 46/100 [01:19<01:00,  1.13s/it] 47%|████▋     | 47/100 [01:19<00:50,  1.05it/s] 48%|████▊     | 48/100 [01:20<00:43,  1.20it/s] 49%|████▉     | 49/100 [01:20<00:38,  1.34it/s] 50%|█████     | 50/100 [01:34<03:53,  4.68s/it] 51%|█████     | 51/100 [01:35<02:49,  3.45s/it] 52%|█████▏    | 52/100 [01:36<02:05,  2.61s/it] 53%|█████▎    | 53/100 [01:36<01:34,  2.00s/it] 54%|█████▍    | 54/100 [01:37<01:11,  1.55s/it] 55%|█████▌    | 55/100 [01:37<00:55,  1.23s/it] 56%|█████▌    | 56/100 [01:38<00:44,  1.01s/it] 57%|█████▋    | 57/100 [01:38<00:37,  1.15it/s] 58%|█████▊    | 58/100 [01:39<00:31,  1.32it/s] 59%|█████▉    | 59/100 [01:39<00:27,  1.49it/s] 60%|██████    | 60/100 [01:53<03:04,  4.62s/it] 61%|██████    | 61/100 [01:54<02:12,  3.40s/it] 62%|██████▏   | 62/100 [01:54<01:37,  2.56s/it] 63%|██████▎   | 63/100 [01:55<01:13,  1.99s/it] 64%|██████▍   | 64/100 [01:55<00:55,  1.53s/it] 65%|██████▌   | 65/100 [01:56<00:43,  1.24s/it] 66%|██████▌   | 66/100 [01:56<00:35,  1.03s/it] 67%|██████▋   | 67/100 [01:57<00:28,  1.16it/s] 68%|██████▊   | 68/100 [01:57<00:25,  1.25it/s] 69%|██████▉   | 69/100 [01:58<00:22,  1.38it/s] 70%|███████   | 70/100 [02:12<02:19,  4.65s/it] 71%|███████   | 71/100 [02:12<01:39,  3.43s/it] 72%|███████▏  | 72/100 [02:13<01:12,  2.57s/it] 73%|███████▎  | 73/100 [02:14<00:53,  2.00s/it] 74%|███████▍  | 74/100 [02:14<00:40,  1.56s/it] 75%|███████▌  | 75/100 [02:15<00:31,  1.26s/it] 76%|███████▌  | 76/100 [02:15<00:25,  1.07s/it] 77%|███████▋  | 77/100 [02:16<00:21,  1.09it/s] 78%|███████▊  | 78/100 [02:16<00:17,  1.23it/s] 79%|███████▉  | 79/100 [02:17<00:15,  1.35it/s] 80%|████████  | 80/100 [02:31<01:34,  4.71s/it] 81%|████████  | 81/100 [02:32<01:05,  3.47s/it] 82%|████████▏ | 82/100 [02:32<00:46,  2.58s/it] 83%|████████▎ | 83/100 [02:33<00:33,  2.00s/it] 84%|████████▍ | 84/100 [02:33<00:24,  1.54s/it] 85%|████████▌ | 85/100 [02:34<00:19,  1.28s/it] 86%|████████▌ | 86/100 [02:34<00:14,  1.05s/it] 87%|████████▋ | 87/100 [02:35<00:11,  1.13it/s] 88%|████████▊ | 88/100 [02:35<00:09,  1.28it/s] 89%|████████▉ | 89/100 [02:36<00:08,  1.34it/s] 90%|█████████ | 90/100 [02:50<00:46,  4.63s/it] 91%|█████████ | 91/100 [02:50<00:30,  3.41s/it] 92%|█████████▏| 92/100 [02:51<00:20,  2.56s/it] 93%|█████████▎| 93/100 [02:51<00:13,  1.94s/it] 94%|█████████▍| 94/100 [02:52<00:09,  1.54s/it] 95%|█████████▌| 95/100 [02:53<00:06,  1.29s/it] 96%|█████████▌| 96/100 [02:53<00:04,  1.08s/it] 97%|█████████▋| 97/100 [02:54<00:02,  1.09it/s] 98%|█████████▊| 98/100 [02:54<00:01,  1.24it/s] 99%|█████████▉| 99/100 [02:55<00:00,  1.41it/s]100%|██████████| 100/100 [03:09<00:00,  4.68s/it]100%|██████████| 100/100 [03:09<00:00,  1.89s/it]
Step round_3_step_10 - AUC: 0.7183, AP: 0.1394
Step round_3_step_20 - AUC: 0.7202, AP: 0.1392
Step round_3_step_30 - AUC: 0.7237, AP: 0.1410
Step round_3_step_40 - AUC: 0.7259, AP: 0.1417
Step round_3_step_50 - AUC: 0.7282, AP: 0.1427
Step round_3_step_60 - AUC: 0.7302, AP: 0.1436
Step round_3_step_70 - AUC: 0.7321, AP: 0.1445
Step round_3_step_80 - AUC: 0.7336, AP: 0.1451
Step round_3_step_90 - AUC: 0.7356, AP: 0.1460
Step round_3_step_100 - AUC: 0.7358, AP: 0.1461
Layer embedding.conv_1.0: 1138839/1572864
Layer cls_head.mlp.0: 94904/131072
Layer cls_head.mlp.2: 93/128
Memory layer Amemory: 22243/30720
Memory layer Nmemory: 22243/30720
Layer selfatt.layers.0.0.fn.to_qkv: 759226/1048576
Layer selfatt.layers.0.0.fn.to_out.0: 379613/524288
Layer selfatt.layers.0.1.fn.net.0: 189807/262144
Layer selfatt.layers.0.1.fn.net.3: 189807/262144
Layer selfatt.layers.1.0.fn.to_qkv: 759226/1048576
Layer selfatt.layers.1.0.fn.to_out.0: 379613/524288
Layer selfatt.layers.1.1.fn.net.0: 189807/262144
Layer selfatt.layers.1.1.fn.net.3: 189807/262144
Layer encoder_mu.0: 189807/262144
Layer encoder_var.0: 189807/262144

After pruning round 4:
Total parameters: 6,484,096
Zero parameters: 4,694,842
Sparsity: 72.41%


Starting pruning round 5/5
Layer embedding.conv_1.0: 1138839/1572864
Layer cls_head.mlp.0: 94904/131072
Layer cls_head.mlp.2: 93/128
Memory layer Amemory: 22243/30720
Memory layer Nmemory: 22243/30720
Layer selfatt.layers.0.0.fn.to_qkv: 759226/1048576
Layer selfatt.layers.0.0.fn.to_out.0: 379613/524288
Layer selfatt.layers.0.1.fn.net.0: 189807/262144
Layer selfatt.layers.0.1.fn.net.3: 189807/262144
Layer selfatt.layers.1.0.fn.to_qkv: 759226/1048576
Layer selfatt.layers.1.0.fn.to_out.0: 379613/524288
Layer selfatt.layers.1.1.fn.net.0: 189807/262144
Layer selfatt.layers.1.1.fn.net.3: 189807/262144
Layer encoder_mu.0: 189807/262144
Layer encoder_var.0: 189807/262144

Starting pruning with target sparsity: 0.8000
Found prunable layer: embedding.conv_1.0, type: Conv1d
Found prunable layer: cls_head.mlp.0, type: Linear
Found prunable layer: cls_head.mlp.2, type: Linear
Found Memory_Unit layer: Amemory
Found Memory_Unit layer: Nmemory
Found prunable layer: selfatt.layers.0.0.fn.to_qkv, type: Linear
Found prunable layer: selfatt.layers.0.0.fn.to_out.0, type: Linear
Found prunable layer: selfatt.layers.0.1.fn.net.0, type: Linear
Found prunable layer: selfatt.layers.0.1.fn.net.3, type: Linear
Found prunable layer: selfatt.layers.1.0.fn.to_qkv, type: Linear
Found prunable layer: selfatt.layers.1.0.fn.to_out.0, type: Linear
Found prunable layer: selfatt.layers.1.1.fn.net.0, type: Linear
Found prunable layer: selfatt.layers.1.1.fn.net.3, type: Linear
Found prunable layer: encoder_mu.0, type: Linear
Found prunable layer: encoder_var.0, type: Linear

Total prunable layers found: 15

Processing layer: embedding.conv_1.0.weight
  Total weights: 1572864
  Current zeros: 1138839
  Target zeros: 1258291
  Need to prune: 119452
  Threshold value: 0.014436
  Zeros after new mask: 1258292

Processing layer: cls_head.mlp.0.weight
  Total weights: 131072
  Current zeros: 94904
  Target zeros: 104857
  Need to prune: 9953
  Threshold value: 0.025094
  Zeros after new mask: 104858

Processing layer: cls_head.mlp.2.weight
  Total weights: 128
  Current zeros: 93
  Target zeros: 102
  Need to prune: 9
  Threshold value: 0.070430
  Zeros after new mask: 103

Processing layer: Amemory.memory_block
  Total weights: 30720
  Current zeros: 22243
  Target zeros: 24576
  Need to prune: 2333
  Threshold value: 0.035395
  Zeros after new mask: 24577

Processing layer: Nmemory.memory_block
  Total weights: 30720
  Current zeros: 22243
  Target zeros: 24576
  Need to prune: 2333
  Threshold value: 0.035258
  Zeros after new mask: 24577

Processing layer: selfatt.layers.0.0.fn.to_qkv.weight
  Total weights: 1048576
  Current zeros: 759226
  Target zeros: 838860
  Need to prune: 79634
  Threshold value: 0.035378
  Zeros after new mask: 838861

Processing layer: selfatt.layers.0.0.fn.to_out.0.weight
  Total weights: 524288
  Current zeros: 379613
  Target zeros: 419430
  Need to prune: 39817
  Threshold value: 0.025024
  Zeros after new mask: 419431

Processing layer: selfatt.layers.0.1.fn.net.0.weight
  Total weights: 262144
  Current zeros: 189807
  Target zeros: 209715
  Need to prune: 19908
  Threshold value: 0.035361
  Zeros after new mask: 209716

Processing layer: selfatt.layers.0.1.fn.net.3.weight
  Total weights: 262144
  Current zeros: 189807
  Target zeros: 209715
  Need to prune: 19908
  Threshold value: 0.035354
  Zeros after new mask: 209716

Processing layer: selfatt.layers.1.0.fn.to_qkv.weight
  Total weights: 1048576
  Current zeros: 759226
  Target zeros: 838860
  Need to prune: 79634
  Threshold value: 0.035399
  Zeros after new mask: 838861

Processing layer: selfatt.layers.1.0.fn.to_out.0.weight
  Total weights: 524288
  Current zeros: 379613
  Target zeros: 419430
  Need to prune: 39817
  Threshold value: 0.025026
  Zeros after new mask: 419431

Processing layer: selfatt.layers.1.1.fn.net.0.weight
  Total weights: 262144
  Current zeros: 189807
  Target zeros: 209715
  Need to prune: 19908
  Threshold value: 0.035329
  Zeros after new mask: 209716

Processing layer: selfatt.layers.1.1.fn.net.3.weight
  Total weights: 262144
  Current zeros: 189807
  Target zeros: 209715
  Need to prune: 19908
  Threshold value: 0.035331
  Zeros after new mask: 209716

Processing layer: encoder_mu.0.weight
  Total weights: 262144
  Current zeros: 189807
  Target zeros: 209715
  Need to prune: 19908
  Threshold value: 0.035385
  Zeros after new mask: 209716

Processing layer: encoder_var.0.weight
  Total weights: 262144
  Current zeros: 189807
  Target zeros: 209715
  Need to prune: 19908
  Threshold value: 0.035334
  Zeros after new mask: 209716
Step round_4_start - AUC: 0.7251, AP: 0.1615
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:58,  1.69it/s]  2%|▏         | 2/100 [00:01<00:59,  1.65it/s]  3%|▎         | 3/100 [00:01<00:54,  1.77it/s]  4%|▍         | 4/100 [00:02<00:59,  1.60it/s]  5%|▌         | 5/100 [00:03<00:58,  1.61it/s]  6%|▌         | 6/100 [00:03<00:54,  1.72it/s]  7%|▋         | 7/100 [00:04<00:51,  1.80it/s]  8%|▊         | 8/100 [00:04<00:50,  1.81it/s]  9%|▉         | 9/100 [00:05<00:55,  1.63it/s] 10%|█         | 10/100 [00:19<07:11,  4.79s/it] 11%|█         | 11/100 [00:20<05:09,  3.48s/it] 12%|█▏        | 12/100 [00:20<03:50,  2.62s/it] 13%|█▎        | 13/100 [00:21<02:52,  1.99s/it] 14%|█▍        | 14/100 [00:21<02:13,  1.55s/it] 15%|█▌        | 15/100 [00:22<01:46,  1.25s/it] 16%|█▌        | 16/100 [00:22<01:31,  1.09s/it] 17%|█▋        | 17/100 [00:23<01:16,  1.09it/s] 18%|█▊        | 18/100 [00:24<01:04,  1.26it/s] 19%|█▉        | 19/100 [00:24<00:55,  1.45it/s] 20%|██        | 20/100 [00:38<06:09,  4.62s/it] 21%|██        | 21/100 [00:38<04:27,  3.39s/it] 22%|██▏       | 22/100 [00:39<03:17,  2.54s/it] 23%|██▎       | 23/100 [00:39<02:29,  1.94s/it] 24%|██▍       | 24/100 [00:40<01:55,  1.52s/it] 25%|██▌       | 25/100 [00:40<01:30,  1.20s/it] 26%|██▌       | 26/100 [00:41<01:14,  1.01s/it] 27%|██▋       | 27/100 [00:41<01:03,  1.15it/s] 28%|██▊       | 28/100 [00:42<00:55,  1.29it/s] 29%|██▉       | 29/100 [00:43<00:50,  1.42it/s] 30%|███       | 30/100 [00:56<05:24,  4.63s/it] 31%|███       | 31/100 [00:57<03:55,  3.41s/it] 32%|███▏      | 32/100 [00:57<02:52,  2.54s/it] 33%|███▎      | 33/100 [00:58<02:08,  1.92s/it] 34%|███▍      | 34/100 [00:59<01:40,  1.52s/it] 35%|███▌      | 35/100 [00:59<01:19,  1.22s/it] 36%|███▌      | 36/100 [01:00<01:04,  1.00s/it] 37%|███▋      | 37/100 [01:00<00:57,  1.09it/s] 38%|███▊      | 38/100 [01:01<00:50,  1.24it/s] 39%|███▉      | 39/100 [01:02<00:47,  1.27it/s] 40%|████      | 40/100 [01:15<04:37,  4.62s/it] 41%|████      | 41/100 [01:16<03:19,  3.38s/it] 42%|████▏     | 42/100 [01:16<02:25,  2.52s/it] 43%|████▎     | 43/100 [01:17<01:49,  1.93s/it] 44%|████▍     | 44/100 [01:17<01:25,  1.53s/it] 45%|████▌     | 45/100 [01:18<01:07,  1.24s/it] 46%|████▌     | 46/100 [01:18<00:54,  1.00s/it] 47%|████▋     | 47/100 [01:19<00:45,  1.17it/s] 48%|████▊     | 48/100 [01:19<00:38,  1.34it/s] 49%|████▉     | 49/100 [01:20<00:36,  1.39it/s] 50%|█████     | 50/100 [01:33<03:46,  4.54s/it] 51%|█████     | 51/100 [01:34<02:43,  3.34s/it] 52%|█████▏    | 52/100 [01:35<02:01,  2.53s/it] 53%|█████▎    | 53/100 [01:35<01:31,  1.94s/it] 54%|█████▍    | 54/100 [01:36<01:09,  1.50s/it] 55%|█████▌    | 55/100 [01:36<00:55,  1.22s/it] 56%|█████▌    | 56/100 [01:37<00:43,  1.00it/s] 57%|█████▋    | 57/100 [01:37<00:36,  1.17it/s] 58%|█████▊    | 58/100 [01:38<00:33,  1.25it/s] 59%|█████▉    | 59/100 [01:38<00:29,  1.39it/s] 60%|██████    | 60/100 [01:52<03:07,  4.68s/it] 61%|██████    | 61/100 [01:53<02:14,  3.45s/it] 62%|██████▏   | 62/100 [01:53<01:37,  2.57s/it] 63%|██████▎   | 63/100 [01:54<01:12,  1.97s/it] 64%|██████▍   | 64/100 [01:54<00:55,  1.55s/it] 65%|██████▌   | 65/100 [01:55<00:43,  1.25s/it] 66%|██████▌   | 66/100 [01:56<00:36,  1.08s/it] 67%|██████▋   | 67/100 [01:56<00:30,  1.07it/s] 68%|██████▊   | 68/100 [01:57<00:25,  1.24it/s] 69%|██████▉   | 69/100 [01:58<00:23,  1.31it/s] 70%|███████   | 70/100 [02:11<02:21,  4.72s/it] 71%|███████   | 71/100 [02:12<01:40,  3.48s/it] 72%|███████▏  | 72/100 [02:13<01:13,  2.61s/it] 73%|███████▎  | 73/100 [02:13<00:53,  1.97s/it] 74%|███████▍  | 74/100 [02:14<00:40,  1.58s/it] 75%|███████▌  | 75/100 [02:14<00:32,  1.32s/it] 76%|███████▌  | 76/100 [02:15<00:26,  1.12s/it] 77%|███████▋  | 77/100 [02:16<00:21,  1.05it/s] 78%|███████▊  | 78/100 [02:16<00:18,  1.20it/s] 79%|███████▉  | 79/100 [02:17<00:15,  1.33it/s] 80%|████████  | 80/100 [02:31<01:33,  4.65s/it] 81%|████████  | 81/100 [02:31<01:04,  3.40s/it] 82%|████████▏ | 82/100 [02:32<00:46,  2.57s/it] 83%|████████▎ | 83/100 [02:32<00:33,  1.99s/it] 84%|████████▍ | 84/100 [02:33<00:24,  1.56s/it] 85%|████████▌ | 85/100 [02:33<00:18,  1.26s/it] 86%|████████▌ | 86/100 [02:34<00:15,  1.10s/it] 87%|████████▋ | 87/100 [02:35<00:12,  1.07it/s] 88%|████████▊ | 88/100 [02:35<00:09,  1.22it/s] 89%|████████▉ | 89/100 [02:36<00:07,  1.38it/s] 90%|█████████ | 90/100 [02:50<00:49,  4.91s/it] 91%|█████████ | 91/100 [02:51<00:32,  3.66s/it] 92%|█████████▏| 92/100 [02:52<00:21,  2.71s/it] 93%|█████████▎| 93/100 [02:52<00:14,  2.04s/it] 94%|█████████▍| 94/100 [02:53<00:09,  1.59s/it] 95%|█████████▌| 95/100 [02:53<00:06,  1.25s/it] 96%|█████████▌| 96/100 [02:54<00:04,  1.01s/it] 97%|█████████▋| 97/100 [02:54<00:02,  1.18it/s] 98%|█████████▊| 98/100 [02:55<00:01,  1.35it/s] 99%|█████████▉| 99/100 [02:55<00:00,  1.51it/s]100%|██████████| 100/100 [03:08<00:00,  4.46s/it]100%|██████████| 100/100 [03:08<00:00,  1.89s/it]
Step round_4_step_10 - AUC: 0.7228, AP: 0.1627
Step round_4_step_20 - AUC: 0.7251, AP: 0.1643
Step round_4_step_30 - AUC: 0.7288, AP: 0.1632
Step round_4_step_40 - AUC: 0.7318, AP: 0.1671
Step round_4_step_50 - AUC: 0.7354, AP: 0.1684
Step round_4_step_60 - AUC: 0.7385, AP: 0.1710
Step round_4_step_70 - AUC: 0.7409, AP: 0.1712
Step round_4_step_80 - AUC: 0.7427, AP: 0.1719
Step round_4_step_90 - AUC: 0.7452, AP: 0.1743
Step round_4_step_100 - AUC: 0.7472, AP: 0.1760
Layer embedding.conv_1.0: 1258292/1572864
Layer cls_head.mlp.0: 104858/131072
Layer cls_head.mlp.2: 103/128
Memory layer Amemory: 24577/30720
Memory layer Nmemory: 24577/30720
Layer selfatt.layers.0.0.fn.to_qkv: 838861/1048576
Layer selfatt.layers.0.0.fn.to_out.0: 419431/524288
Layer selfatt.layers.0.1.fn.net.0: 209716/262144
Layer selfatt.layers.0.1.fn.net.3: 209716/262144
Layer selfatt.layers.1.0.fn.to_qkv: 838861/1048576
Layer selfatt.layers.1.0.fn.to_out.0: 419431/524288
Layer selfatt.layers.1.1.fn.net.0: 209716/262144
Layer selfatt.layers.1.1.fn.net.3: 209716/262144
Layer encoder_mu.0: 209716/262144
Layer encoder_var.0: 209716/262144

After pruning round 5:
Total parameters: 6,484,096
Zero parameters: 5,187,287
Sparsity: 80.00%

